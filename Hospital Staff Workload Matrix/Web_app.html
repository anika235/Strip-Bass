<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hospital Staff Workload Matrix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              sans: ["Poppins", "sans-serif"],
            },
          },
        },
      };
    </script>
    <style>
      #matrixPreview::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      #matrixPreview::-webkit-scrollbar-track {
        background: #e2e8f0; /* slate-200 */
        border-radius: 10px;
      }
      .dark #matrixPreview::-webkit-scrollbar-track {
        background: #334155; /* slate-700 */
      }
      #matrixPreview::-webkit-scrollbar-thumb {
        background: #94a3b8; /* slate-400 */
        border-radius: 10px;
      }
      .dark #matrixPreview::-webkit-scrollbar-thumb {
        background: #64748b; /* slate-500 */
      }
      #matrixPreview::-webkit-scrollbar-thumb:hover {
        background: #64748b; /* slate-500 */
      }
      .dark #matrixPreview::-webkit-scrollbar-thumb:hover {
        background: #475569; /* slate-600 */
      }
      input,
      select,
      textarea {
        outline: none;
      }
      select:focus,
      input:focus,
      textarea:focus {
        outline: none;
      }
      .smooth-transition {
        transition-property: all;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        transition-duration: 200ms;
      }
    </style>
  </head>
  <body
    class="font-sans bg-gradient-to-br from-sky-50 to-indigo-100 dark:from-slate-800 dark:to-slate-900 text-slate-800 dark:text-slate-100 min-h-screen p-4 md:p-6"
  >
    <div
      class="max-w-6xl mx-auto mb-6 p-4 md:p-6 rounded-xl shadow-lg bg-white dark:bg-slate-800/70 backdrop-blur-md flex justify-between items-center border border-slate-200 dark:border-slate-700 smooth-transition hover:shadow-xl hover:-translate-y-0.5"
    >
      <h1
        class="text-xl md:text-2xl font-bold text-indigo-600 dark:text-sky-400 flex items-center smooth-transition hover:text-indigo-700 dark:hover:text-sky-300"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-8 h-8 mr-3"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"
          />
        </svg>
        Hospital Staff Workload Matrix
      </h1>
      <div class="flex items-center">
        <span class="mr-2 text-sm font-medium text-slate-700 dark:text-slate-300"
          >Light / Dark</span
        >
        <label
          class="relative inline-flex items-center cursor-pointer smooth-transition hover:opacity-80"
        >
          <input type="checkbox" id="theme-toggle" class="sr-only peer" />
          <div
            class="w-14 h-7 bg-slate-300 rounded-full peer peer-checked:bg-indigo-500 transition-all dark:bg-slate-600"
          ></div>
          <div
            class="absolute left-1 top-1 w-5 h-5 bg-white rounded-full transition-all peer-checked:translate-x-7"
          ></div>
        </label>
      </div>
    </div>

    <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
      <div
        class="lg:col-span-5 p-6 rounded-xl shadow-xl bg-white/70 dark:bg-slate-800/50 backdrop-blur-lg space-y-6 border border-slate-200 dark:border-slate-700 smooth-transition hover:shadow-2xl hover:-translate-y-1"
      >
        <h2
          class="text-xl font-semibold text-indigo-600 dark:text-sky-400 mb-4 pb-2 border-b-2 border-indigo-200 dark:border-sky-700 flex items-center smooth-transition hover:text-indigo-700 dark:hover:text-sky-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-7 h-7 mr-2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.108 1.204.165.397.505.71.93.78l.895.149c.542.09.94.56.94 1.11v1.093c0 .55-.398 1.02-.94 1.11l-.895.149c-.425.07-.765.383-.93.78-.165.398-.143.854.108 1.204l.527.738c.32.447.27.96-.12 1.45l-.773.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.78.93l-.149.895c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.895c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527a1.125 1.125 0 01-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.506-.71-.93-.78l-.895-.149c-.542-.09-.94-.56-.94-1.11v-1.094c0 .55.398-1.02.94-1.11l.895-.149c.424-.07.765-.383.93-.78.165-.398.143.854-.108-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.93l.149-.895z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
            />
          </svg>
          Input Configuration
        </h2>

        <div>
          <label
            for="matrixTitle"
            class="flex items-center text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-5 h-5 mr-2 text-slate-500 dark:text-slate-400"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"
              />
            </svg>
            Matrix Title
          </label>
          <input
            type="text"
            id="matrixTitle"
            value="Workload Matrix"
            class="mt-1 w-full py-3 px-4 rounded-md border-2 border-slate-300 dark:border-slate-600 shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:border-indigo-500 dark:focus:ring-indigo-500 bg-slate-50/80 dark:bg-slate-700/60 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 smooth-transition hover:border-indigo-400 dark:hover:border-sky-500"
          />
        </div>

        <div>
          <label
            for="focusArea"
            class="flex items-center text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-5 h-5 mr-2 text-slate-500 dark:text-slate-400"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 6h.008v.008H6V6z"
              />
            </svg>
            Focus Area
          </label>
          <select
            id="focusArea"
            class="mt-1 w-full py-3 px-4 rounded-md border-2 border-slate-300 dark:border-slate-600 shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:border-indigo-500 dark:focus:ring-indigo-500 bg-slate-50/80 dark:bg-slate-700/60 dark:text-white smooth-transition hover:border-indigo-400 dark:hover:border-sky-500"
          >
            <option value="HR">HR</option>
            <option value="Operations">Operations</option>
            <option value="Nursing">Nursing</option>
            <option value="Finance">Finance</option>
            <option value="IT">IT</option>
          </select>
        </div>

        <div>
          <label
            for="matrixData"
            class="flex items-center text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-5 h-5 mr-2 text-slate-500 dark:text-slate-400"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"
              />
            </svg>
            Matrix Data (Rows: newlines, Columns: commas)
          </label>
          <textarea
            id="matrixData"
            rows="6"
            class="mt-1 w-full py-3 px-4 rounded-md border-2 border-slate-300 dark:border-slate-600 shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:border-indigo-500 dark:focus:ring-indigo-500 bg-slate-50/80 dark:bg-slate-700/60 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 smooth-transition hover:border-indigo-400 dark:hover:border-sky-500"
            placeholder="Example:&#10;Task Name,Hours,Priority&#10;Patient Check-ins,20,High&#10;Medication Rounds,15,High&#10;Charting,25,Medium"
          ></textarea>
        </div>

        <div>
          <button
            id="resetButton"
            class="w-full bg-rose-500 text-white py-2.5 px-4 rounded-md hover:bg-rose-600 dark:bg-rose-600 dark:hover:bg-rose-700 text-sm font-medium flex items-center justify-center shadow-md hover:shadow-lg smooth-transition transform hover:scale-105"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-5 h-5 mr-2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"
              />
            </svg>
            Reset Matrix
          </button>
        </div>
      </div>

      <div
        class="lg:col-span-7 p-6 rounded-xl shadow-xl bg-white/70 dark:bg-slate-800/50 backdrop-blur-lg flex flex-col space-y-4 border border-slate-200 dark:border-slate-700 smooth-transition hover:shadow-2xl hover:-translate-y-1"
      >
        <h2
          id="previewTitle"
          class="text-xl font-semibold text-indigo-600 dark:text-sky-400 mb-4 pb-2 border-b-2 border-indigo-200 dark:border-sky-700 flex-shrink-0 flex items-center smooth-transition hover:text-indigo-700 dark:hover:text-sky-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-7 h-7 mr-2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25A2.25 2.25 0 0113.5 8.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"
            />
          </svg>
          Workload Matrix (HR)
        </h2>
        <div
          id="matrixPreview"
          class="overflow-x-auto overflow-y-auto h-96 flex-grow bg-slate-50/50 dark:bg-slate-700/30 rounded-lg p-2 md:p-3"
        >
          <table
            class="min-w-full border-collapse border border-slate-300 dark:border-slate-600"
          >
            <tbody id="matrixTable"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div
      id="confirmationModal"
      class="fixed inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden p-4"
    >
      <div
        class="bg-slate-100 dark:bg-slate-800 rounded-xl p-6 shadow-2xl w-full max-w-md text-slate-800 dark:text-slate-100 space-y-4"
      >
        <h3 class="text-xl font-semibold text-indigo-600 dark:text-sky-400">
          Confirm Reset
        </h3>
        <p class="mt-2 text-sm text-slate-600 dark:text-slate-300">
          Are you sure you want to reset the matrix? All current data will be
          lost.
        </p>
        <div class="mt-6 flex justify-end space-x-3">
          <button
            id="cancelResetBtn"
            class="px-4 py-2 bg-slate-300 text-slate-800 rounded-md hover:bg-slate-400 dark:bg-slate-600 dark:text-slate-200 dark:hover:bg-slate-500 text-sm font-medium smooth-transition transform hover:scale-105"
          >
            Cancel
          </button>
          <button
            id="confirmResetBtn"
            class="px-4 py-2 bg-rose-500 text-white rounded-md hover:bg-rose-600 dark:bg-rose-600 dark:hover:bg-rose-700 text-sm font-medium smooth-transition transform hover:scale-105"
          >
            Confirm Reset
          </button>
        </div>
      </div>
    </div>

    <div
      id="editCellModal"
      class="fixed inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden p-4"
    >
      <div
        class="bg-slate-100 dark:bg-slate-800 rounded-xl p-6 shadow-2xl w-full max-w-md text-slate-800 dark:text-slate-100 space-y-4"
      >
        <h3 class="text-xl font-semibold text-indigo-600 dark:text-sky-400">
          Edit Cell Value
        </h3>
        <input
          type="text"
          id="editCellInput"
          class="mt-1 w-full py-3 px-4 rounded-md border-2 border-slate-300 dark:border-slate-600 shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:border-indigo-500 dark:focus:ring-indigo-500 bg-white dark:bg-slate-700 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 smooth-transition hover:border-indigo-400 dark:hover:border-sky-500"
        />
        <div class="mt-6 flex justify-end space-x-3">
          <button
            id="cancelEditBtn"
            class="px-4 py-2 bg-slate-300 text-slate-800 rounded-md hover:bg-slate-400 dark:bg-slate-600 dark:text-slate-200 dark:hover:bg-slate-500 text-sm font-medium smooth-transition transform hover:scale-105"
          >
            Cancel
          </button>
          <button
            id="saveCellBtn"
            class="px-4 py-2 bg-indigo-500 text-white rounded-md hover:bg-indigo-600 dark:bg-sky-500 dark:hover:bg-sky-600 text-sm font-medium smooth-transition transform hover:scale-105"
          >
            Save Changes
          </button>
        </div>
      </div>
    </div>

    <script>
      const themeToggle = document.getElementById("theme-toggle");
      const matrixTitleInput = document.getElementById("matrixTitle");
      const focusAreaSelect = document.getElementById("focusArea");
      const matrixDataInput = document.getElementById("matrixData");
      const resetButton = document.getElementById("resetButton");
      const previewTitle = document.getElementById("previewTitle");
      const matrixTable = document.getElementById("matrixTable");

      const confirmationModal = document.getElementById("confirmationModal");
      const confirmResetBtn = document.getElementById("confirmResetBtn");
      const cancelResetBtn = document.getElementById("cancelResetBtn");

      const editCellModal = document.getElementById("editCellModal");
      const editCellInput = document.getElementById("editCellInput");
      const saveCellBtn = document.getElementById("saveCellBtn");
      const cancelEditBtn = document.getElementById("cancelEditBtn");

      let matrixData = [];
      let currentEditingCell = { row: null, col: null };

      themeToggle.addEventListener("change", () => {
        if (themeToggle.checked) {
          document.documentElement.classList.add("dark");
          localStorage.setItem("theme", "dark");
        } else {
          document.documentElement.classList.remove("dark");
          localStorage.setItem("theme", "light");
        }
      });

      function applyInitialTheme() {
        const storedTheme = localStorage.getItem("theme");
        if (
          storedTheme === "dark" ||
          (!storedTheme &&
            window.matchMedia("(prefers-color-scheme: dark)").matches)
        ) {
          document.documentElement.classList.add("dark");
          themeToggle.checked = true;
        } else {
          document.documentElement.classList.remove("dark");
          themeToggle.checked = false;
        }
      }

      function updatePreviewTitle() {
        const title = matrixTitleInput.value || "Workload Matrix";
        const focus = focusAreaSelect.value;
        const iconHTML = `
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7 mr-2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25A2.25 2.25 0 0113.5 8.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" />
          </svg>`;
        previewTitle.innerHTML = `${iconHTML} ${title} (${focus})`;
      }

      function parseAndRenderMatrix() {
        const input = matrixDataInput.value.trim();
        if (!input) {
          matrixData = [];
          renderMatrix();
          return;
        }

        try {
          const rows = input.split("\n").map((row) => row.trim());
          const filteredRows = rows.filter((row) => row.length > 0);
          matrixData = filteredRows.map((row) =>
            row.split(",").map((cell) => cell.trim()),
          );
          renderMatrix();
        } catch (e) {
          console.error("Error parsing data:", e);
          matrixData = [];
          renderMatrix();
        }
      }

      function renderMatrix() {
        matrixTable.innerHTML = "";
        if (
          matrixData.length === 0 ||
          matrixData.every(
            (row) => row.length === 0 || row.every((cell) => cell === ""),
          )
        ) {
          matrixTable.innerHTML =
            '<tr><td class="border border-slate-300 dark:border-slate-600 p-4 text-slate-500 dark:text-slate-400 text-center align-middle h-80 flex items-center justify-center">Enter data in the "Matrix Data" field to see the matrix.</td></tr>';
          return;
        }

        matrixData.forEach((row, rowIndex) => {
          const tr = document.createElement("tr");
          tr.className =
            "hover:bg-slate-100/50 dark:hover:bg-slate-700/50 smooth-transition";
          row.forEach((cell, colIndex) => {
            const td = document.createElement("td");
            td.className =
              "border border-slate-300 dark:border-slate-600 p-1 text-center text-sm text-slate-700 dark:text-slate-200";
            const cellTextNode = document.createTextNode(cell || "");
            const span = document.createElement("span");
            span.className =
              "cursor-pointer p-2 rounded block w-full h-full min-h-[28px] flex items-center justify-center smooth-transition transform hover:bg-indigo-100 dark:hover:bg-sky-700 hover:font-medium hover:scale-[1.03] hover:shadow-sm";
            span.appendChild(cellTextNode);
            td.appendChild(span);
            td.addEventListener("click", () =>
              openEditCellModal(rowIndex, colIndex),
            );
            tr.appendChild(td);
          });
          matrixTable.appendChild(tr);
        });
      }

      function openEditCellModal(rowIndex, colIndex) {
        currentEditingCell = { row: rowIndex, col: colIndex };
        editCellInput.value = matrixData[rowIndex][colIndex] || "";
        editCellModal.classList.remove("hidden");
        editCellInput.focus();
        editCellInput.select();
      }

      function closeEditCellModal() {
        editCellModal.classList.add("hidden");
      }

      saveCellBtn.addEventListener("click", () => {
        const { row, col } = currentEditingCell;
        if (row !== null && col !== null && matrixData[row]) {
          matrixData[row][col] = editCellInput.value;
          syncTextareaFromMatrix();
        }
        closeEditCellModal();
      });

      cancelEditBtn.addEventListener("click", closeEditCellModal);
      editCellInput.addEventListener("keypress", function (event) {
        if (event.key === "Enter") {
          event.preventDefault();
          saveCellBtn.click();
        }
      });

      function syncTextareaFromMatrix() {
        matrixDataInput.value = matrixData
          .map((row) => row.join(","))
          .join("\n");
        matrixDataInput.dispatchEvent(
          new Event("input", { bubbles: true, cancelable: true }),
        );
      }

      function performReset() {
        matrixTitleInput.value = "Workload Matrix";
        focusAreaSelect.value = "HR";
        matrixDataInput.value = "";
        matrixData = [];
        updatePreviewTitle();
        parseAndRenderMatrix();
      }

      resetButton.addEventListener("click", () => {
        confirmationModal.classList.remove("hidden");
      });

      confirmResetBtn.addEventListener("click", () => {
        performReset();
        confirmationModal.classList.add("hidden");
      });

      cancelResetBtn.addEventListener("click", () => {
        confirmationModal.classList.add("hidden");
      });

      document.addEventListener("keydown", (event) => {
        if (event.key === "Escape") {
          if (!confirmationModal.classList.contains("hidden")) {
            cancelResetBtn.click();
          }
          if (!editCellModal.classList.contains("hidden")) {
            cancelEditBtn.click();
          }
        }
      });

      matrixTitleInput.addEventListener("input", updatePreviewTitle);
      focusAreaSelect.addEventListener("change", updatePreviewTitle);
      matrixDataInput.addEventListener("input", parseAndRenderMatrix);

      applyInitialTheme();
      updatePreviewTitle();
      parseAndRenderMatrix();
    </script>
  </body>
</html>